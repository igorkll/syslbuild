{
    "min-syslbuild-version": [0, 6, 0],
    
    "architectures": [
        "i386"
    ],

    "builditems": [
        // install basic system
        {
            "type": "debian",
            "name": "rootfs directory",
            "export": false,
    
            "kernel": "default",
            "include": [
                "initramfs-tools",
                "mpg123",
                "pulseaudio",
                "pulseaudio-utils",
                "systemd",
                "systemd-sysv",
                "dbus"
            ],
    
            "variant": "minbase",
            "suite": "bookworm",
            "url": "http://snapshot.debian.org/archive/debian/20250809T133719Z"
        },

        // create rootfs
        {
            "type": "directory",
            "name": "rootfs directory x2",
            "export": false,

            "items": [
                ["rootfs directory", "."],
                ["files/main.sh", "/main.sh", [0, 0, "0755"]],
                ["files/sound.mp3", "/sound.mp3", [0, 0, "0644"]],
                ["files/mp3player.service", "/etc/systemd/system/mp3player.service", [0, 0, "0644"]],
                ["files/custom_init.sh", "/usr/share/initramfs-tools/init", [0, 0, "0755"]]
            ]
        },
        {
            "type": "smart-chroot",
            "name": "rootfs directory x3",
            "export": false,

            "source": "rootfs directory x2",
            "scripts": [
                "chroot/setup.sh"
            ]
        },
        {
            "type": "filesystem",
            "name": "rootfs.img",
            "export": false,

            "source": "rootfs directory x3",

            "fs_type": "ext4",
            "size": "(auto * 1.2) + (100 * 1024 * 1024)",
            "label": "mp3play"
        },

        // pack bootable image
        {
            "type": "full-disk-image",
            "name": "mp3play.img",
            "export": true,

            "size": "auto + (1 * 1024 * 1024)",

            "partitionTable": "dos",
            "partitions": [
                ["rootfs.img", "linux"]
            ],

            "bootloader": {
                "type": "grub",
                "config": "files/grub.cfg",
                "boot": 0,
                "modules": [
                    "normal",
                    "part_msdos",
                    "part_gpt",
                    "ext2",
                    "configfile"
                ]
            }
        }
    ]
}